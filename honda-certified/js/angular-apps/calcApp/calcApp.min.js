var calcApp=angular.module("calcApp",["rzModule","ngSanitize"]);
calcApp.config([function(){}]),calcApp.factory("utils",function(){var t=function(t,c){c||(c=location.href),t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var e="[\\?&]"+t+"=([^&#]*)",n=new RegExp(e),l=n.exec(c);return null==l?null:l[1]};return{gup:t,_console:function(){return{log:function(c){1==t("debug")&&console.log("+ calcApp: "+c)},log2:function(c){1==t("debug")&&(console.log("+ calcApp: =============== start ==============="),console.log(c),console.log("+ calcApp: =============== end ==============="))},log3:function(c,e){1==t("debug")&&(console.log("+ calcApp: =============== "+c+" ==============="),console.log(e))}}}}}),calcApp.directive("inputLock",function(){return{template:'<span class="lock {{ lockObject.getLockStatusClass() }} {{lockObject.getUnlockableClass()}} "></span>',replace:!0,restrict:"E",scope:{lockObject:"="},compile:function(t,c){return{post:function(c,e,n){t.bind("click",function(){c.$apply(function(){c.lockObject.toggleLock(),c.lockObject.isLocked()?c.lockObject.disableSlider():c.lockObject.enableSlider()})})}}}}}),calcApp.directive("numberInput",function(){return{link:function(t,c){$(c).on("keypress",function(t){return t.metaKey||t.which<=0||8==t.which||/[0-9,.]/.test(String.fromCharCode(t.which))})},restrict:"A"}}),calcApp.directive("format",["$filter",function(t){return{require:"?ngModel",link:function(c,e,n,l){l&&(l.$formatters.unshift(function(c){return t(n.format)(l.$modelValue)}),l.$parsers.unshift(function(c){var l=c.replace(/[^\d|\-+|\.+]/g,"");return e.val(t(n.format)(l)),l}))}}}]),calcApp.factory("calcDataService",["$http","utils",function(t,c){var e=new c._console;return{getData:function(c){return e.log('Calling handler: "'+c+'"'),t({method:"GET",url:c}).then(function(t){return e.log("Call successful"),e.log2(t),t.data},function(t){e.log("Call unsuccessful"),e.log(t.status)})}}}]),calcApp.filter("tel",function(){return function(t){if(console.log(t),!t)return"";var c=t.toString().trim().replace(/^\+/,"");if(c.match(/[^0-9]/))return t;var e,n;switch(c.length){case 1:case 2:case 3:e=c;break;default:e=c.slice(0,3),n=c.slice(3)}return n?(n=n.length>3?n.slice(0,3)+"-"+n.slice(3,7):n,("("+e+") "+n).trim()):"("+e}}),calcApp.filter("zipcode",function(){return function(t){return t?9===t.toString().length?t.toString().slice(0,5)+"-"+t.toString().slice(5):5===t.toString().length?t.toString():t:t}});
calcApp.controller("calcCtrl",["$scope","$http","$timeout","$location","calcDataService","utils",function(e,t,n,o,l,r){var a,i,c,s=new r._console,u=function(e){var t,n=function(){return t},o=function(e){t=e},l=function(){var t=e.Output.Results.Settings.Setting[7]["#cdata-section"];if(null==t)throw new Error("apr not found");o(t)};return function(){l()}(),{getAPR:n}},d=function(e){var t,n=function(){return t},o=function(e){t=e},l=function(){var t=e.Output.Results.Settings.Setting[5]["#cdata-section"];if(null==t)throw new Error("kbb trade in url not found");o(t)};return function(){l()}(),{getUrl:n}},f=function(e){var t,n=function(){return t},o=function(e){t=e},l=function(){var t=e.Output.Results.Settings.Setting[0].Item;if(null==t)throw console.log("FianceTerms not found 78 "),new Error("FianceTerms not found");o(t)},r=function(){var t=e.Output.Results.Settings.Setting[0].Item,n=null;if(null==t&&console.log("FianceTerms not found 91 "),Array.isArray(t))for(var o=0,l=t.length;o<l;o++)"object"==typeof t[o]&&void 0!=t[o]["@default"]&&"true"==t[o]["@default"]&&(n=t[o]["#text"],console.log("defaultTerm: ",n));return n};return function(){l()}(),{getTerms:n,getDefaultTerm:r}},m=function(e){var t,n,o,l,r,a,i,c,s,u,d,f,m,g,v,p,h,C,M,b,y,S;y=null;var k=e.Output.Results.Models.Model[0],D=k.ModelVINsOnSite.VIN[0],F=null;k.Specials["@Count"]>0&&(F=k.Specials.Special[0]);var P=function(){return t},T=function(e){t=e},$=function(){var e=k["@DealerId"];null!=e&&void 0!=e&&T(e)},w=function(){return n},N=function(e){n=e},A=function(){var e=k["@ModelId"];null!=e&&void 0!=e&&N(e)},O=function(){return o},I=function(e){o=e},E=function(){var e=k.ModelYear;null!=e&&void 0!=e&&I(e)},V=function(){return l},R=function(e){l=e},L=function(){var e=k.ModelGroupName;null!=e&&void 0!=e&&R(e)},x=function(){return r},_=function(e){r=e},j=function(){var e=k.ModelTrim;null!=e&&void 0!=e&&_(e)},B=function(){return a},G=function(e){a=e},H=function(){var e=k.ModelMarketingName;null!=e&&void 0!=e&&G(e)},K=function(){return i},U=function(e){i=e},Y=function(){var e=k.ModelTransmission;null!=e&&void 0!=e&&U(e)},Z=function(){return c},z=function(e){c=e},J=function(){var e=k.ModelTransmissionMarketingName;null!=e&&void 0!=e&&z(e)},W=function(){return s},q=function(e){s=e},Q=function(){var e=k.ModelMSRP;null!=e&&void 0!=e&&q(e)},X=function(){return u},ee=function(e){u=e},te=function(){var e=k.DHCost;null!=e&&void 0!=e&&ee(e)},ne=function(){return d},oe=function(e){d=e},le=function(){var e=D.VIN;null!=e&&void 0!=e&&oe(e)},re=function(){return f},ae=function(e){f=e},ie=function(){var e=D.Mileage;null!=e&&void 0!=e&&ae(e)},ce=function(){return m},se=function(e){m=e},ue=function(){var e=D.DSRP;null!=e&&void 0!=e&&se(e)},de=function(){return g},fe=function(e){g=e},me=function(){var e=D.CertDate;null!=e&&void 0!=e&&fe(e)},ge=function(){return v},ve=function(e){v=e},pe=function(){var e=D.ModelExteriorColorName;null!=e&&void 0!=e&&ve(e)},he=function(){return p},Ce=function(e){p=e},Me=function(){var e=D.ModelExteriorColorCD;null!=e&&void 0!=e&&Ce(e)},be=function(){return h},ye=function(e){h=e},Se=function(){var e=D.ModelBaseColor;null!=e&&void 0!=e&&ye(e)},ke=function(){return C},De=function(e){C=e},Fe=function(){var e=D.ModelInteriorColorName;null!=e&&void 0!=e&&De(e)},Pe=function(){return M},Te=function(e){M=e},$e=function(){var e=D.ModelInteriorColorCD;null!=e&&void 0!=e&&Te(e)},we=function(){return S},Ne=function(e){S=e},Ae=function(){var e=D.StockNo;null!=e&&void 0!=e&&Ne(e)},Oe=!1,Ie=!1,Ee=function(){return b},Ve=function(e){b=e},Re=function(){var e=function(e){for(var t=Array.prototype.slice.call(arguments,1),n=0;n<t.length;n++){if(!e||!e.hasOwnProperty(t[n]))return!1;e=e[t[n]]}return!0},t="";if(e(D,"Photos","Photos","Photo[1]",'["#text"]'))t=D.Photos.Photos.Photo[1]["#text"],Oe=!0;else if(e(D,"ModelStockPhotos")&&Array.isArray(D.ModelStockPhotos.Photos))for(var n=0,o=D.ModelStockPhotos.Photos.length;n<o;n++)if("BASECAR"==D.ModelStockPhotos.Photos[n]["@TypeCD"]&&Array.isArray(D.ModelStockPhotos.Photos[n].Photo))for(var l=0,r=D.ModelStockPhotos.Photos[n].Photo.length;l<r;l++)"34FRONT"==D.ModelStockPhotos.Photos[n].Photo[l]["@ViewCD"]&&(t=D.ModelStockPhotos.Photos[n].Photo[l]["#text"],Ie=!0);null!=t&&void 0!=t&&Ve("https://automobiles.honda.com"+t)},Le=function(){return Oe?"dealer-photo":Ie?"stock-photo":""},xe=function(){return y},_e=function(e){y=e},je=function(){var e=F;null!=e&&void 0!=e&&_e(e)},Be=function(){if(null!=y)return 1==y["@id"]},Ge=function(){var e="";return e+=""!=O()&&null!=O()&&void 0!=O()?O()+" ":"",e+=""!=V()&&null!=V()&&void 0!=V()?V()+" ":"",e+=""!=B()&&null!=B()&&void 0!=B()?B():""};return __construct=function(){$(),A(),E(),L(),j(),H(),Y(),J(),Q(),te(),le(),ie(),ue(),me(),pe(),Me(),Se(),Fe(),$e(),Re(),je(),Ae()},__construct(),{getDealerId:P,getModelId:w,getModelYear:O,getModelGroupName:V,getModelTrim:x,getModelMarketingName:B,getModelTransmission:K,getModelTransmissionMarketingName:Z,getModelMSRP:W,getDHCost:X,getVIN:ne,getMileage:re,getDSRP:ce,getCertDate:de,getModelExteriorColorName:ge,getModelExteriorColorCD:he,getModelBaseColor:be,getModelInteriorColorName:ke,getModelInteriorColorCD:Pe,getPhoto1:Ee,getOffer:xe,hasOffer:Be,getYourCarName:Ge,getStockNo:we,setContainerClassBasedOnPhoto:Le}},g=null,v=function(e){var t,n,o,l,r,a,i,c,s,u,d,f,m,g,v,p=e.Output.Results.Dealers.Dealer[0],h=function(){return t},C=function(e){t=e},M=function(){var e=p.DealerID;null!=e&&void 0!=e&&C(e)},b=function(){return n},y=function(e){n=e},S=function(){var e=p.DealerName;null!=e&&void 0!=e&&y(e)},k=function(){return o},D=function(e){o=e},F=function(){var e=p.DealerAddress;null!=e&&void 0!=e&&D(e)},P=function(){return l},T=function(e){l=e},$=function(){var e=p.DealerCity;null!=e&&void 0!=e&&T(e)},w=function(){return r},N=function(e){r=e},A=function(){var e=p.DealerState;null!=e&&void 0!=e&&N(e)},O=function(){return a},I=function(e){a=e},E=function(){var e=p.DealerZip;null!=e&&void 0!=e&&I(e)},V=function(){return i},R=function(e){i=e},L=function(){var e=p.DealerHours;null!=e&&void 0!=e&&R(e)},x=function(){return c},_=function(e){c=e},j=function(){var e=p.DealerDistance;null!=e&&void 0!=e&&_(e)},B=function(){return s},G=function(e){s=e},H=function(){var e=p.DealerLat;null!=e&&void 0!=e&&G(e)},K=function(){return u},U=function(e){u=e},Y=function(){var e=p.DealerLong;null!=e&&void 0!=e&&U(e)},Z=function(){return d},z=function(e){d=e},J=function(){var e=p.DealerURL;null!=e&&void 0!=e&&z(e)},W=function(){return f},q=function(e){f=e},Q=function(){var e=p.DealerInternetMngr;null!=e&&void 0!=e&&q(e)},X=function(){return m},ee=function(e){m=e},te=function(){var e=p.DealerEmail;null!=e&&void 0!=e&&ee(e)},ne=function(){return g},oe=function(e){g=e},le=function(){var e=p.DealerPhoneNo;null!=e&&void 0!=e&&oe(e)},re=function(){return v},ae=function(e){v=e},ie=function(){var e=p.DealerFaxNo;null!=e&&void 0!=e&&ae(e)};return __construct=function(){M(),S(),F(),$(),A(),E(),L(),j(),H(),Y(),J(),Q(),te(),le(),ie()},__construct(),{getDealerID:h,getDealerName:b,getDealerAddress:k,getDealerCity:P,getDealerState:w,getDealerZip:O,getDealerHours:V,getDealerDistance:x,getDealerLat:B,getDealerLong:K,getDealerURL:Z,getDealerInternetMngr:W,getDealerEmail:X,getDealerPhoneNo:ne,getDealerFaxNo:re}};dealer=null;var p=function(e){var t=this;t.value=e||null,t.set=function(e){t.vinValue=e},t.get=function(){return t.vinValue},t.exists=function(){return!!r.gup("vin")&&(t.set(r.gup("vin")),!0)}},h=new p;e.vin=h;var C=function(e){var t=null,n=function(){return t},o=function(e){t=e},l=function(){var t=e.Output.Results.Specials.Special[0];null==t?console.log("null offer"):o(t)},r=function(){return null!=t},a=[],i=function(){return a},c=function(){var t;t=Array.isArray(e.Output.Results.Specials.Special[0].PaymentTerms.FinanceTerms.FinanceTerm)?e.Output.Results.Specials.Special[0].PaymentTerms.FinanceTerms.FinanceTerm[0]:e.Output.Results.Specials.Special[0].PaymentTerms.FinanceTerms.FinanceTerm,null!=t.TermMin&&void 0!=t.TermMin&&""!=t.TermMin&&a.push(t.TermMin),null!=t.TermMax&&void 0!=t.TermMax&&""!=t.TermMax&&a.push(t.TermMax)},s=function(){return t.SpecialDescription},u=function(){return t.SalesProgramName},d=function(){return t.PaymentTerms.FinanceTerms.SampleFinancePayment.SampleAPR};return function(){l(),c()}(),{getOffer:n,setOffer:o,exists:r,getAPR:d,getContent:s,getTitle:u,getTerms:i}},M=function(e){var t=this;t.mode=e,t.getMode=function(){return t.mode},t.setMode=function(e){return t.mode=e},t.getPageInfo=function(){return{lName:"ComputeFlag",value:t.mode}},t.removeVin=function(){window.history.pushState("object or string","Title","/"+window.location.href.substring(window.location.href.lastIndexOf("/")+1).split("?")[0]),N.unlockable=!1,N.enableSlider(),N.setLock(!1),P.unlockable=!1,P.enableSlider(),I.enableFieldSystem(),I.enableSlider(),I.set(a.getAPR()),g.hasOffer()&&(w.slider=w.originalSlider,w.set(w.slider.ceil),w.enableFieldSystem(),w.hideMsg()),b.setMode("normal"),b.setFirstCall(!0),S.setMode("normal"),S.apiCallController(),$("html, body").animate({scrollTop:$(".row .section-calculator").offset().top},350)},t.firstCall=!0,t.setFirstCall=function(e){t.firstCall=e},t.isFirstCall=function(){return!0===t.firstCall}},b=new M("normal");e.page=b,e.calcAnimation=null,e.getCalcAnimation=function(){return e.calcAnimation},e.setCalcAnimation=function(t){e.calcAnimation=t},e.showCalcAnimation=function(){if(e.calcAnimation)return"calculation-animation"};var y=function(){var n,o,l=function(){return n},p=function(e){n=e},M=function(){return o},y=function(e){o=e.toUpperCase()},k=function(){return{lName:"ComputeFlag",value:M()}},D=function(e){for(var t=[],n=0,o=e.length;n<o;n++)t.push(e[n].lName+"="+e[n].value);return t.join("&")},$=function(n){t({method:"GET",url:"/handlers/get-payment-calculator-reverse.ashx?"+n}).then(function(t){var n=t.data;console.log("mp: "),console.log(P.value),console.log(n),void 0!==n&&(e.calcError.clearMessage(),e.calcErrorInput.clearMessage());var o=n.Output.Results;if(console.log(o),o.Term<w.slider.floor)return void e.calcError.setMessage({msg:"The values selected result in an invalid term length. Try adjusting your values to get a valid term length ("+w.slider.floor+" to "+w.slider.ceil+") months",closeButton:!1,template:"A"});if(o.Term>w.slider.ceil)return void e.calcError.setMessage({msg:"The combination of values you have selected results in a term length greater than "+w.slider.ceil+". Try adjusting your values to get a valid term length",closeButton:!1,template:"A"});P.set(e.mpObj.value),T.set(e.dpObj.value),w.set(e.tlObj.value),e.vpObj.value=o.FinanceBudget,N.set(e.vpObj.value),console.log("NEW VP OBJ from calc data handler: "),console.log(N),console.log(o.FinanceBudget),e.filteredArray=x(V,N.value),console.log(e.filteredArray),e.modelCount=e.filteredArray.length,E(),e.setCalcAnimation(!1)},function(t){console.log("calc data handler error"),e.calcError.setMessage({msg:"Sorry about that! There seems to be a glitch in the matrix. We've dispatched a team of helper-bots to get this feature back up and running soon. Please check back in a bit.",closeButton:!0,template:"A"})})},O=function(){N.set("-"),T.set(0),A.set(0),S.setComputeFlag("MP");var n=null;t({method:"GET",url:"/handlers/get-payment-calculator-constants.ashx"}).then(function(t){s.log("+++++++++++ 1"),s.log("calc constants - calcConstantsHandler");var o=t.data;s.log2(o),a=new u(o),e.usedVehicleDefaultAPR=a,I.set(a.getAPR()),i=new d(o),e.kbbTradeInUrl=i,c=new f(o),e.financeTerms=c,s.log2(c.getTerms()),w.set(c.getDefaultTerm()),n=D([I,w,P,T,A]),b.setFirstCall(!1),$(n)},function(t){e.calcError.setMessage({msg:"Sorry about that! We've dispatched a team of helper-bots to get this feature back up and running soon. Please check back in a bit.",closeButton:!0,template:"A"})})},R=function(n){t({method:"GET",url:"/handlers/get-payment-calculator-constants.ashx"}).then(function(t){var n=t.data;s.log("+++++++++++ 1"),s.log("calc constants - vehicleDetailsHandler"),s.log2(n),a=new u(n),e.usedVehicleDefaultAPR=a,I.set(a.getAPR()),i=new d(n),e.kbbTradeInUrl=i,c=new f(n),e.financeTerms=c,s.log2(c.getTerms()),_params=D([I,w,N,T,A,S.getComputeFlagInfo()]),b.setFirstCall(!1)},function(t){e.calcError.setMessage({msg:"An error occured during calculation",errorCode:"1003",closeButton:!0,template:"A"})}).then(function(){t({method:"GET",url:"/handlers/get-vehicle-details.ashx?vin="+n}).then(function(t){var n=null,o=t.data;s.log2(o),g=new m(o),e.vehicle=g,dealer=new v(o),e.dealer=dealer,N.set(g.getDSRP()),N.setLock(!0),N.unlockable=!0,N.disableSlider(),T.set(0),null!=r.gup("kbbMSRP")?A.set(r.gup("kbbMSRP")):A.set(0),g.hasOffer()?(n=new C(o),e.offer=n,s.log3("Offer",n.getOffer()),w.originalSlider=w.slider,w.offerSlider={floor:parseInt(n.getTerms()[0]),ceil:parseInt(n.getTerms()[1]),step:parseInt(n.getTerms()[1]-n.getTerms()[0]),ticksArray:n.getTerms(),showSelectionBarEnd:!0,onEnd:S.apiCallController},w.slider=w.offerSlider,w.set(w.offerSlider.ceil),w.showMsg(),w.disableFieldSystem(),w.offerSlider.ceil==w.offerSlider.floor?w.setMsg("Limited to "+w.offerSlider.ceil+" months for offer"):w.setMsg("Limited to "+w.offerSlider.floor+" - "+w.offerSlider.ceil+" months for offer"),I.set(n.getAPR()),I.disableFieldSystem(),I.disableSlider()):(console.log("there is no offer"),console.log("financeTerms.getDefaultTerm(): ",c.getDefaultTerm()),w.set(c.getDefaultTerm()),w.setMsg(""),w.hideMsg(),I.set(a.getAPR())),S.setComputeFlag("MP"),_params=D([I,w,N,T,A,k()]),$(_params),b.setFirstCall(!1)},function(t){e.calcError.setMessage({msg:"Sorry about that! We've dispatched a team of helper-bots to get this feature back up and running soon. Please check back in a bit.",closeButton:!0,template:"A"})})})},L=function(e){if(void 0!=e){var t=F(e),n="";if(!0!==t.touched&&"mp,vp,dp,tl".indexOf(e)>=0){switch(e){case"mp":n="paycalc_slider_monthlypayment";break;case"vp":n="paycalc_slider_vehicleprice";break;case"dp":n="paycalc_slider_downpayment";break;case"tl":n="paycalc_slider_termlength"}_satellite.track(n),s.log("dtm tag triggered for "+e),t.touched=!0}}};return{getMode:l,setMode:p,getComputeFlag:M,setComputeFlag:y,getComputeFlagInfo:k,apiCallController:function(e){var t=S.getMode(),n=e||null,o=null;L(e);var l=function(){if(P.isNotLocked()&&N.isNotLocked()){switch(e){case"mp":S.setComputeFlag("DP");break;default:S.setComputeFlag("MP")}switch(S.getComputeFlag()){case"MP":case"DP":o=D([I,w,P,T,A])}}else if(N.isLocked()&&P.isNotLocked()){switch(e){case"mp":S.setComputeFlag("DP");break;default:S.setComputeFlag("MP")}switch(S.getComputeFlag()){case"MP":o=D([I,w,T,A,k()]);break;case"DP":o=D([I,w,P,A,k()])}}else if(P.isLocked()&&N.isNotLocked()){switch(e){case"dp":S.setComputeFlag("VP");break;default:S.setComputeFlag("DP")}switch(S.getComputeFlag()){case"VP":o=D([I,w,T,P,A,k()]);break;case"DP":o=D([I,w,P,A,k()])}}else if(N.isLocked()&&P.isLocked()){switch(e){case"dp":S.setComputeFlag("T");break;default:S.setComputeFlag("DP")}switch(S.getComputeFlag()){case"DP":o=D([I,w,P,A,k()]);break;case"T":o=D([I,N,T,P,A,k()])}}};"normal"==t&&b.isFirstCall()?(console.log("calc mode normal / first page call"),O()):"normal"!=t||b.isFirstCall()?"vehicle"==t&&b.isFirstCall()?R(h.get()):"vehicle"!=t||b.isFirstCall()||(l(),s.log("Calc mode: "+t+', slider: "'+n+'" was changed, setting computeFlag to "'+S.getComputeFlag()+'"'),s.log("Params to send to calcDataHandler: "+o),$(o)):(console.log("calc mode normal / not first page call"),l(),$(o))}}},S=new y,k=function(t,n,o){var l=this;l.touched=!1,l.sName=t,l.lName=n,l.value=o||null,l.lock=!1,l.unlockable=!1,l.slider={},l.get=function(){return l.value},l.set=function(e){l.value=parseFloat(e)},l.el=$("input[name="+l.sName+"]")[0],l.$el=$("input[name="+l.sName+"]"),l.setLock=function(e){l.lock=e},l.isLocked=function(){return!0===l.lock},l.isNotLocked=function(){return!1===this.lock},l.isValid=function(){return!e.calculatorForm[t]||e.calculatorForm[t].$valid},l.getLockStatusClass=function(){return!0===l.lock?"locked":"unlocked"},l.toggleLock=function(){l.unlockable||(l.isLocked()?l.setLock(!1):l.setLock(!0))},l.getUnlockableClass=function(){return l.unlockable?"can-not-be-unlocked":"can-be-unlocked"},l.$msg=l.$el.closest(".calc-group").find(".msg span"),l.getMsg=function(){return l.$msg},l.setMsg=function(e){l.$msg.html(e)},l.showMsg=function(){l.$msg.show()},l.hideMsg=function(){l.$msg.hide()},l.getLockInfo=function(){return{lName:l.sName+"Lock",value:l.lock}},l.morphNonInput=function(){l.$el.closest(".calc-group").addClass("morph-non-input")},l.morphInput=function(){l.$el.closest(".calc-group").removeClass("morph-non-input")},l.enableSlider=function(){l.slider.disabled=!1},l.disableSlider=function(){l.slider.disabled=!0},l.disableField=function(){l.el.disabled=!0},l.enableField=function(){l.el.disabled=!1},l.enableReadonly=function(){l.el.readOnly=!0},l.disbleReadonly=function(){l.el.readOnly=!1},l.disableFieldSystem=function(){l.el.disabled=!0,l.$el.closest(".calc-group").addClass("system-disabled")},l.enableFieldSystem=function(){l.el.disabled=!1,l.$el.closest(".calc-group").removeClass("system-disabled")},l.setErrorBorder=function(){l.$el.addClass("api-error")},l.removeErrorBorder=function(){l.$el.removeClass("api-error")},l.showSlider=function(){l.$el.css("display","block")},l.hideSlider=function(){l.$el.css("display","none")}},D=[];e.allFields=D;var F=function(e){for(var t=0,n=D.length;t<n;t++)if(e==D[t].sName)return D[t]},P=new k("mp","MonthlyPayment");P.validate=function(){this.value<100?e.calculatorForm.mp.$setValidity("min",!1):e.calculatorForm.mp.$setValidity("min",!0),this.value>1e3?e.calculatorForm.mp.$setValidity("max",!1):e.calculatorForm.mp.$setValidity("max",!0)},D.push(P);var T=new k("dp","DownPayment");T.validate=function(){this.value>=99999?e.calculatorForm.dp.$setValidity("max",!1):e.calculatorForm.dp.$setValidity("max",!0)},D.push(T);var w=new k("tl","Term");D.push(w);var N=new k("vp","MSRP");N.validate=function(){this.value>this.slider.ceil?e.calculatorForm.vp.$setValidity("max",!1):e.calculatorForm.vp.$setValidity("max",!0),this.value<this.slider.floor?e.calculatorForm.vp.$setValidity("min",!1):e.calculatorForm.vp.$setValidity("min",!0)},D.push(N);var A=new k("etv","TradeInValue");A.validate=function(){this.value>=99999?e.calculatorForm.etv.$setValidity("max",!1):e.calculatorForm.etv.$setValidity("max",!0)},D.push(A);var O=new k("etf","estimatedTaxesFees");D.push(O);var I=new k("apr","APR");I.validate=function(){this.value>this.slider.ceil?e.calculatorForm.apr.$setValidity("max",!1):e.calculatorForm.apr.$setValidity("max",!0),this.value<this.slider.floor?e.calculatorForm.apr.$setValidity("min",!1):e.calculatorForm.apr.$setValidity("min",!0)},D.push(I);var E=function(){if(console.log("validating..."),N.isValid()&&A.isValid()&&T.isValid()){if(N.get()-A.get()-T.get()<5e3)return e.calculatorForm.$setValidity("financeAmount",!1),e.calcFinanceErrorInput.setMessage({msg:"Readjust your values. The minimum finance amount is $5,000.",closeButton:!1,template:"A"}),void e.calcErrorInput.clearMessage();e.calcFinanceErrorInput.clearMessage()}e.calculatorForm.$setValidity("financeAmount",!0)};e.mpObj=P,e.dpObj=T,e.tlObj=w,e.vpObj=N,e.etvObj=A,e.etfObj=O,e.aprObj=I,e.offerAppliedCheckbox=function(t){var n=t.target;console.info("this msg"),console.info(w.$msg),1==n.checked?(I.set(e.offer.getAPR()),I.disableFieldSystem(),I.disableSlider(),w.slider=w.offerSlider,w.set(w.slider.ceil),w.disableFieldSystem(),w.showMsg(),S.apiCallController()):(I.enableFieldSystem(),I.enableSlider(),I.set(a.getAPR()),w.slider=w.originalSlider,w.enableFieldSystem(),w.hideMsg(),S.apiCallController())},e.termLengthOptions=[24,36,48,60,72];var V=[],R=function(){P.slider={id:"mp",floor:100,ceil:1e3,ticksArray:[100,500,1e3],showTicksValues:!0,showSelectionBarEnd:!0,disabled:P.isLocked(),translate:function(e){return"$"+e},onEnd:function(e){floodLightSessionManager("endtf0"),P.validate(),E(),S.apiCallController(e),console.log("mp slider touched")}},T.slider={id:"dp",floor:0,ceil:2e4,ticksArray:[0,5e3,1e4,2e4],showTicksValues:!0,showSelectionBarEnd:!0,translate:function(e){var t;switch(e){case 5e3:t="5K";break;case 1e4:t="10K";break;case 2e4:t="20K";break;default:t="$"+e}return t},onEnd:function(e){floodLightSessionManager("endtf0"),T.validate(),E(),S.apiCallController(e)}},w.slider={id:"tl",floor:24,ceil:72,step:12,ticksArray:[24,36,48,60,72],showTicksValues:!0,showSelectionBarEnd:!0,onEnd:function(){floodLightSessionManager("endtf0"),S.apiCallController()}},I.slider={id:"apr",precision:1,floor:.1,ceil:15,step:.1,ticksArray:[0,5,10,15],showTicksValues:!0,showSelectionBarEnd:!0,onEnd:function(e){floodLightSessionManager("endtf0"),I.validate(),S.apiCallController(e)}},N.slider={id:"vp",floor:5e3,ceil:5e4,ticksArray:[5e3,1e4,2e4,5e4],showTicksValues:!0,showSelectionBarEnd:!0,disabled:N.isLocked(),translate:function(e){var t;switch(e){case 5e3:t="5K";break;case 1e4:t="10K";break;case 2e4:t="20K";break;case 5e4:t="50K";break;default:t="$"+e}return t},onEnd:function(e){floodLightSessionManager("endtf0"),N.validate(),E(),S.apiCallController(e)}}},L=function(t){switch(floodLightSessionManager("endtf0"),isNaN(parseFloat(t.get()))&&t.set(t.slider.floor||0),t.sName){case"apr":I.validate();break;case"vp":N.validate(),E();break;case"dp":T.validate(),E();break;case"etv":A.validate(),E();break;case"mp":P.validate(),E()}S.apiCallController(t.sName),console.log("new VP: "),console.log(e.vpObj.value),e.filteredArray=x(V,e.vpObj.value)};e.termLengthSelect=function(t,n){var o=angular.element(t.currentTarget);o.parent().children().removeClass("active"),o.addClass("active"),e.tlObj.value=n},e.fieldChanged=L,e.applyKbbValue=function(t){e.$apply(function(){A.set(t),S.apiCallController("etv")})};var x=function(t,n){var o=[];console.log("array (pre filter): "),console.log(t);for(var l=parseFloat(n),r=0;r<t.length;r++)for(var a=0;a<t[r].ModelVINsOnSite.VIN.length;a++)parseFloat(t[r].ModelVINsOnSite.VIN[a].DSRP)<l&&o.push(t[r].ModelVINsOnSite.VIN[a]);return 0==o?(1==_&&e.calcErrorInput.setMessage({msg:"Readjust your values to find vehicles within your budget."}),e.calcFinanceErrorInput.clearMessage()):e.calcErrorInput.clearMessage(),_=!0,console.log("array (post filter): "),console.log(o),o},_=!1,j=function(n,o){var l="zip="+n+"&radius="+o;console.log(l);var r={},a=[];t({method:"GET",url:"/handlers/get-inventory-data.ashx?"+l}).then(function(t){r=t.data.Output.Results,console.log("ALL MODELS AVAILABLE FOR: "+l),e.modelCount=r.TotalRecordCount,a=r.Models.Model,console.log(r)},function(e){console.log("failed to fetch inventory from handler")}).then(function(){console.log("finished retrieving inventory"),console.log(e.vpObj.value),e.filteredArray=x(a,e.vpObj.value),V=a,e.modelCount=e.filteredArray.length})};!function(){e.tlObj.value=60,e.mpObj.value=370;var t=localStorageGetItemCommon("_GeoCurrentZipCode");j(t,25),e.calcError=new hcpv_rpa_util.GenError({container:$(".calc-general-error")}),e.calcErrorInput=new hcpv_rpa_util.GenError({container:$(".calc-summary-error")}),e.calcFinanceErrorInput=new hcpv_rpa_util.GenError({container:$(".calc-finance-error")}),h.exists()?(b.setMode("vehicle"),S.setMode("vehicle")):(b.setMode("normal"),S.setMode("normal")),R(),$(function(){$(document).on("focus","input[type=text]",function(){this.select()})}),S.apiCallController(),e.vehicleSearch=function(e){o.path("/vehicle-search?price="+e)},e.setCalcAnimation(!1),e.closeContactDealerOverlay=function(){$(".contact-overlay, .contact-layer, .gallery-layer").fadeOut(300)},e.openContactDealerOverlay=function(){$(".contact-thankyou").hide(),$(".contact-box").first().fadeIn(300),$(".contact-overlay, .email-dealer-layer .contact-layer").fadeIn(300)},e.sendDealerEmail=function(){var t=$("#contact-zip").val(),n=$("#contact-first-name").val(),o=$("#contact-last-name").val(),l=$("#contact-email").val(),r=$("input:radio[name=radio_tradein]:checked").val();if(r="tradein"==r,$(".contact-form .form-control").each(function(){""==$.trim($(this).val())?$(this).addClass("form-error"):$(this).removeClass("form-error")}),""==$.trim(t)||0==hcpv_rpa_util.validateZipCode(t)?$("#contact-zip").addClass("form-error"):$("#contact-zip").removeClass("form-error"),""==$.trim(l)||0==hcpv_rpa_util.validateEmail(l)?$("#contact-email").addClass("form-error"):$("#contact-email").removeClass("form-error"),$(".contact-form").find(".form-error").length>0)return!1;var a=e.vehicle,i=e.dealer,c={FirstName:n,LastName:o,ZipCode:t,Email:l,ModelYear:a.getModelYear(),ModelMake:"Honda",ModelMarketingName:a.getModelGroupName()+" "+a.getModelTrim(),DealerName:i.getDealerName(),DealerAddress:i.getDealerAddress()+" "+i.getDealerCity()+", "+i.getDealerState()+" "+i.getDealerZip(),DealerPhone:i.getDealerPhoneNo(),VehicleImage:a.getPhoto1(),ModelTrim:a.getModelTrim(),ModelPrice:a.getDSRP(),Model:{modelId:a.getModelId(),modelGroupName:null,modelYearStart:0,modelYearEnd:0,modelExteriorColorCd:a.getModelExteriorColorName(),modelInteriorColorCd:a.getModelInteriorColorName(),modelPriceLimit:0,modelTransmission:null,modelVin:g.getVIN(),modelMileage:0,modelDealerStockNumber:a.getStockNo(),ModelConfiguredDSRP:a.getDSRP()},Dealer:{dealerId:i.getDealerID()},CarToTradeIn:r};console.log(c),console.log(JSON.stringify(c));$.post("/handlers/submit-dealer-request-handler.ashx",{dealerRequest:JSON.stringify(c)},function(e){console.log(e),e=JSON.parse(e),e=e.Output,"submitted"==e.Results.Status.toLowerCase()?($(".contact-box").first().fadeOut(300),$(".contact-thankyou-name").html(n),$(".contact-thankyou").fadeIn(300),callFloodlight("contact-dealer"),_satellite.setVar("dealername",i.getDealerName()),_satellite.track('"modeldetail_contact_submit')):console.error("could not contact dealer")}).fail(function(){console.error("could not contact dealer")})}}()}]);
!function(e,t){"use strict";function r(e,r,n){return{restrict:"ECA",terminal:!0,priority:400,transclude:"element",link:function(a,o,i,c,l){function u(){$&&(n.cancel($),$=null),h&&(h.$destroy(),h=null),f&&($=n.leave(f),$.then(function(){$=null}),f=null)}function s(){var i=e.current&&e.current.locals;if(t.isDefined(i&&i.$template)){var i=a.$new(),c=e.current;f=l(i,function(e){n.enter(e,null,f||o).then(function(){!t.isDefined(d)||d&&!a.$eval(d)||r()}),u()}),h=c.scope=i,h.$emit("$viewContentLoaded"),h.$eval(p)}else u()}var h,f,$,d=i.autoscroll,p=i.onload||"";a.$on("$routeChangeSuccess",s),s()}}}function n(e,t,r){return{restrict:"ECA",priority:-400,link:function(n,a){var o=r.current,i=o.locals;a.html(i.$template);var c=e(a.contents());if(o.controller){i.$scope=n;var l=t(o.controller,i);o.controllerAs&&(n[o.controllerAs]=l),a.data("$ngControllerController",l),a.children().data("$ngControllerController",l)}n[o.resolveAs||"$resolve"]=i,c(n)}}}var a,o,i=t.module("ngRoute",["ng"]).provider("$route",function(){function e(e,r){return t.extend(Object.create(e),r)}function r(e,t){var r=t.caseInsensitiveMatch,n={originalPath:e,regexp:e},a=n.keys=[];return e=e.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)(\*\?|[\?\*])?/g,function(e,t,r,n){return e="?"===n||"*?"===n?"?":null,n="*"===n||"*?"===n?"*":null,a.push({name:r,optional:!!e}),t=t||"",(e?"":t)+"(?:"+(e?t:"")+(n&&"(.+?)"||"([^/]+)")+(e||"")+")"+(e||"")}).replace(/([\/$\*])/g,"\\$1"),n.regexp=new RegExp("^"+e+"$",r?"i":""),n}a=t.isArray,o=t.isObject;var n={};this.when=function(e,i){var c;if(c=void 0,a(i)){c=c||[];for(var l=0,u=i.length;l<u;l++)c[l]=i[l]}else if(o(i))for(l in c=c||{},i)"$"===l.charAt(0)&&"$"===l.charAt(1)||(c[l]=i[l]);return c=c||i,t.isUndefined(c.reloadOnSearch)&&(c.reloadOnSearch=!0),t.isUndefined(c.caseInsensitiveMatch)&&(c.caseInsensitiveMatch=this.caseInsensitiveMatch),n[e]=t.extend(c,e&&r(e,c)),e&&(l="/"===e[e.length-1]?e.substr(0,e.length-1):e+"/",n[l]=t.extend({redirectTo:e},r(l,c))),this},this.caseInsensitiveMatch=!1,this.otherwise=function(e){return"string"==typeof e&&(e={redirectTo:e}),this.when(null,e),this},this.$get=["$rootScope","$location","$routeParams","$q","$injector","$templateRequest","$sce",function(r,a,o,i,l,u,s){function h(e){var n=P.current;(g=(m=p())&&n&&m.$$route===n.$$route&&t.equals(m.pathParams,n.pathParams)&&!m.reloadOnSearch&&!w)||!n&&!m||r.$broadcast("$routeChangeStart",m,n).defaultPrevented&&e&&e.preventDefault()}function f(){var e=P.current,n=m;g?(e.params=n.params,t.copy(e.params,o),r.$broadcast("$routeUpdate",e)):(n||e)&&(w=!1,(P.current=n)&&n.redirectTo&&(t.isString(n.redirectTo)?a.path(v(n.redirectTo,n.params)).search(n.params).replace():a.url(n.redirectTo(n.pathParams,a.path(),a.search())).replace()),i.when(n).then($).then(function(a){n===P.current&&(n&&(n.locals=a,t.copy(n.params,o)),r.$broadcast("$routeChangeSuccess",n,e))},function(t){n===P.current&&r.$broadcast("$routeChangeError",n,e,t)}))}function $(e){if(e){var r=t.extend({},e.resolve);return t.forEach(r,function(e,n){r[n]=t.isString(e)?l.get(e):l.invoke(e,null,null,n)}),e=d(e),t.isDefined(e)&&(r.$template=e),i.all(r)}}function d(e){var r,n;return t.isDefined(r=e.template)?t.isFunction(r)&&(r=r(e.params)):t.isDefined(n=e.templateUrl)&&(t.isFunction(n)&&(n=n(e.params)),t.isDefined(n)&&(e.loadedTemplateUrl=s.valueOf(n),r=u(n))),r}function p(){var r,o;return t.forEach(n,function(n,i){var c;if(c=!o){var l=a.path();c=n.keys;var u={};if(n.regexp)if(l=n.regexp.exec(l)){for(var s=1,h=l.length;s<h;++s){var f=c[s-1],$=l[s];f&&$&&(u[f.name]=$)}c=u}else c=null;else c=null;c=r=c}c&&(o=e(n,{params:t.extend({},a.search(),r),pathParams:r}),o.$$route=n)}),o||n[null]&&e(n[null],{params:{},pathParams:{}})}function v(e,r){var n=[];return t.forEach((e||"").split(":"),function(e,t){if(0===t)n.push(e);else{var a=e.match(/(\w+)(?:[?*])?(.*)/),o=a[1];n.push(r[o]),n.push(a[2]||""),delete r[o]}}),n.join("")}var m,g,w=!1,P={routes:n,reload:function(){w=!0;var e={defaultPrevented:!1,preventDefault:function(){this.defaultPrevented=!0,w=!1}};r.$evalAsync(function(){h(e),e.defaultPrevented||f()})},updateParams:function(e){if(!this.current||!this.current.$$route)throw c("norout");e=t.extend({},this.current.params,e),a.path(v(this.current.$$route.originalPath,e)),a.search(e)}};return r.$on("$locationChangeStart",h),r.$on("$locationChangeSuccess",f),P}]}),c=t.$$minErr("ngRoute");i.provider("$routeParams",function(){this.$get=function(){return{}}}),i.directive("ngView",r),i.directive("ngView",n),r.$inject=["$route","$anchorScroll","$animate"],n.$inject=["$compile","$controller","$route"]}(window,window.angular);
!function(e,t){"use strict";function r(e){var t=[];return h(t,c).chars(e),t.join("")}var n,i,o,a,s,l,c,u,d,h,f=t.$$minErr("$sanitize");t.module("ngSanitize",[]).provider("$sanitize",function(){function r(e,t){return m(e.split(","),t)}function m(e,t){var r,n={};for(r=0;r<e.length;r++)n[t?l(e[r]):e[r]]=!0;return n}function p(e,t){t&&t.length&&i(e,m(t))}function g(e){for(var t={},r=0,n=e.length;r<n;r++){var i=e[r];t[i.name]=i.value}return t}function v(e){return e.replace(/&/g,"&amp;").replace(w,function(e){var t=e.charCodeAt(0);return e=e.charCodeAt(1),"&#"+(1024*(t-55296)+(e-56320)+65536)+";"}).replace(C,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function y(t){for(;t;){if(t.nodeType===e.Node.ELEMENT_NODE)for(var r=t.attributes,n=0,i=r.length;n<i;n++){var o=r[n],a=o.name.toLowerCase();"xmlns:ns1"!==a&&0!==a.lastIndexOf("ns1:",0)||(t.removeAttributeNode(o),n--,i--)}(r=t.firstChild)&&y(r),t=b("nextSibling",t)}}function b(e,t){var r=t[e];if(r&&u.call(t,r))throw f("elclob",t.outerHTML||t.outerText);return r}var x=!1,k=!1;this.$get=["$$sanitizeUri",function(e){return x=!0,k&&i(M,z),function(t){var r=[];return d(t,h(r,function(t,r){return!/^unsafe:/.test(e(t,r))})),r.join("")}}],this.enableSvg=function(e){return s(e)?(k=e,this):k},this.addValidElements=function(e){return x||(a(e)&&(e={htmlElements:e}),p(z,e.svgElements),p(E,e.htmlVoidElements),p(M,e.htmlVoidElements),p(M,e.htmlElements)),this},this.addValidAttrs=function(e){return x||i(N,m(e,!0)),this},n=t.bind,i=t.extend,o=t.forEach,a=t.isArray,s=t.isDefined,l=t.$$lowercase,c=t.noop,d=function(e,t){null===e||void 0===e?e="":"string"!=typeof e&&(e=""+e);var r=q(e);if(!r)return"";var n=5;do{if(0===n)throw f("uinput");n--,e=r.innerHTML,r=q(e)}while(e!==r.innerHTML);for(n=r.firstChild;n;){switch(n.nodeType){case 1:t.start(n.nodeName.toLowerCase(),g(n.attributes));break;case 3:t.chars(n.textContent)}var i;if(!((i=n.firstChild)||(1===n.nodeType&&t.end(n.nodeName.toLowerCase()),i=b("nextSibling",n))))for(;null==i&&(n=b("parentNode",n))!==r;)i=b("nextSibling",n),1===n.nodeType&&t.end(n.nodeName.toLowerCase());n=i}for(;n=r.firstChild;)r.removeChild(n)},h=function(e,t){var r=!1,i=n(e,e.push);return{start:function(e,n){e=l(e),!r&&D[e]&&(r=e),r||!0!==M[e]||(i("<"),i(e),o(n,function(r,n){var o=l(n),a="img"===e&&"src"===o||"background"===o;!0!==N[o]||!0===$[o]&&!t(r,a)||(i(" "),i(n),i('="'),i(v(r)),i('"'))}),i(">"))},end:function(e){e=l(e),r||!0!==M[e]||!0===E[e]||(i("</"),i(e),i(">")),e==r&&(r=!1)},chars:function(e){r||i(v(e))}}},u=e.Node.prototype.contains||function(e){return!!(16&this.compareDocumentPosition(e))};var w=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,C=/([^#-~ |!])/g,E=r("area,br,col,hr,img,wbr"),T=r("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),L=r("rp,rt"),S=i({},L,T),T=i({},T,r("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,section,table,ul")),L=i({},L,r("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),z=r("circle,defs,desc,ellipse,font-face,font-face-name,font-face-src,g,glyph,hkern,image,linearGradient,line,marker,metadata,missing-glyph,mpath,path,polygon,polyline,radialGradient,rect,stop,svg,switch,text,title,tspan"),D=r("script,style"),M=i({},E,T,L,S),$=r("background,cite,href,longdesc,src,xlink:href,xml:base"),S=r("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,tabindex,target,title,type,valign,value,vspace,width"),L=r("accent-height,accumulate,additive,alphabetic,arabic-form,ascent,baseProfile,bbox,begin,by,calcMode,cap-height,class,color,color-rendering,content,cx,cy,d,dx,dy,descent,display,dur,end,fill,fill-rule,font-family,font-size,font-stretch,font-style,font-variant,font-weight,from,fx,fy,g1,g2,glyph-name,gradientUnits,hanging,height,horiz-adv-x,horiz-origin-x,ideographic,k,keyPoints,keySplines,keyTimes,lang,marker-end,marker-mid,marker-start,markerHeight,markerUnits,markerWidth,mathematical,max,min,offset,opacity,orient,origin,overline-position,overline-thickness,panose-1,path,pathLength,points,preserveAspectRatio,r,refX,refY,repeatCount,repeatDur,requiredExtensions,requiredFeatures,restart,rotate,rx,ry,slope,stemh,stemv,stop-color,stop-opacity,strikethrough-position,strikethrough-thickness,stroke,stroke-dasharray,stroke-dashoffset,stroke-linecap,stroke-linejoin,stroke-miterlimit,stroke-opacity,stroke-width,systemLanguage,target,text-anchor,to,transform,type,u1,u2,underline-position,underline-thickness,unicode,unicode-range,units-per-em,values,version,viewBox,visibility,width,widths,x,x-height,x1,x2,xlink:actuate,xlink:arcrole,xlink:role,xlink:show,xlink:title,xlink:type,xml:base,xml:lang,xml:space,xmlns,xmlns:xlink,y,y1,y2,zoomAndPan",!0),N=i({},$,L,S),q=function(e,t){function r(t){t="<remove></remove>"+t;try{var r=(new e.DOMParser).parseFromString(t,"text/html").body;return r.firstChild.remove(),r}catch(e){}}function n(e){return o.innerHTML=e,t.documentMode&&y(o),o}var i;if(!t||!t.implementation)throw f("noinert");i=t.implementation.createHTMLDocument("inert");var o=(i.documentElement||i.getDocumentElement()).querySelector("body");return o.innerHTML='<svg><g onload="this.parentNode.remove()"></g></svg>',o.querySelector("svg")?(o.innerHTML='<svg><p><style><img src="</style><img src=x onerror=alert(1)//">',o.querySelector("svg img")?r:n):function(t){t="<remove></remove>"+t;try{t=encodeURI(t)}catch(e){return}var r=new e.XMLHttpRequest;return r.responseType="document",r.open("GET","data:text/html;charset=utf-8,"+t,!1),r.send(null),t=r.response.body,t.firstChild.remove(),t}}(e,e.document)}).info({angularVersion:"1.7.2"}),t.module("ngSanitize").filter("linky",["$sanitize",function(e){var n=/((s?ftp|https?):\/\/|(www\.)|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>"\u201d\u2019]/i,i=/^mailto:/i,o=t.$$minErr("linky"),a=t.isDefined,s=t.isFunction,l=t.isObject,c=t.isString;return function(t,u,d){function h(e){e&&v.push(r(e))}if(null==t||""===t)return t;if(!c(t))throw o("notstring",t);for(var f,m,p=s(d)?d:l(d)?function(){return d}:function(){return{}},g=t,v=[];t=g.match(n);)f=t[0],t[2]||t[4]||(f=(t[3]?"http://":"mailto:")+f),m=t.index,h(g.substr(0,m)),function(e,t){var r,n=p(e);v.push("<a ");for(r in n)v.push(r+'="'+n[r]+'" ');!a(u)||"target"in n||v.push('target="',u,'" '),v.push('href="',e.replace(/"/g,"&quot;"),'">'),h(t),v.push("</a>")}(f,t[0].replace(i,"")),g=g.substring(m+t[0].length);return h(g),e(v.join(""))}}])}(window,window.angular);
!function(i,t){"use strict";if("function"==typeof define&&define.amd)define(["angular"],t);else if("object"==typeof module&&module.exports){var s=angular||require("angular");s&&s.module||"undefined"==typeof angular||(s=angular),module.exports=t(s)}else t(i.angular)}(this,function(i){"use strict";var t=i.module("rzModule",[]).factory("RzSliderOptions",function(){var t={floor:0,ceil:null,step:1,precision:0,minRange:null,maxRange:null,pushRange:!1,minLimit:null,maxLimit:null,id:null,translate:null,getLegend:null,stepsArray:null,bindIndexForStepsArray:!1,draggableRange:!1,draggableRangeOnly:!1,showSelectionBar:!1,showSelectionBarEnd:!1,showSelectionBarFromValue:null,hidePointerLabels:!1,hideLimitLabels:!1,autoHideLimitLabels:!0,readOnly:!1,disabled:!1,interval:350,showTicks:!1,showTicksValues:!1,ticksArray:null,ticksTooltip:null,ticksValuesTooltip:null,vertical:!1,getSelectionBarColor:null,getTickColor:null,getPointerColor:null,keyboardSupport:!0,scale:1,enforceStep:!0,enforceRange:!1,noSwitching:!1,onlyBindHandles:!1,onStart:null,onChange:null,onEnd:null,rightToLeft:!1,boundPointerLabels:!0,mergeRangeLabelsIfSame:!1,customTemplateScope:null,logScale:!1,customValueToPosition:null,customPositionToValue:null,selectionBarGradient:null,ariaLabel:null,ariaLabelledBy:null,ariaLabelHigh:null,ariaLabelledByHigh:null},s={},e={};return e.options=function(t){i.extend(s,t)},e.getOptions=function(e){return i.extend({},t,s,e)},e}).factory("rzThrottle",["$timeout",function(i){return function(t,s,e){var n,o,a,h=Date.now||function(){return(new Date).getTime()},l=null,r=0;e=e||{};var u=function(){r=h(),l=null,a=t.apply(n,o),n=o=null};return function(){var p=h(),c=s-(p-r);return n=this,o=arguments,0>=c?(i.cancel(l),l=null,r=p,a=t.apply(n,o),n=o=null):l||!1===e.trailing||(l=i(u,c)),a}}}]).factory("RzSlider",["$timeout","$document","$window","$compile","RzSliderOptions","rzThrottle",function(t,s,e,n,o,a){var h=function(i,t){this.scope=i,this.lowValue=0,this.highValue=0,this.sliderElem=t,this.range=void 0!==this.scope.rzSliderModel&&void 0!==this.scope.rzSliderHigh,this.dragging={active:!1,value:0,difference:0,position:0,lowLimit:0,highLimit:0},this.positionProperty="left",this.dimensionProperty="width",this.handleHalfDim=0,this.maxPos=0,this.precision=0,this.step=1,this.tracking="",this.minValue=0,this.maxValue=0,this.valueRange=0,this.intermediateTicks=!1,this.initHasRun=!1,this.firstKeyDown=!1,this.internalChange=!1,this.cmbLabelShown=!1,this.currentFocusElement=null,this.fullBar=null,this.selBar=null,this.minH=null,this.maxH=null,this.flrLab=null,this.ceilLab=null,this.minLab=null,this.maxLab=null,this.cmbLab=null,this.ticks=null,this.init()};return h.prototype={init:function(){var t,s,n=this,o=function(){n.calcViewDimensions()};this.applyOptions(),this.syncLowValue(),this.range&&this.syncHighValue(),this.initElemHandles(),this.manageElementsStyle(),this.setDisabledState(),this.calcViewDimensions(),this.setMinAndMax(),this.addAccessibility(),this.updateCeilLab(),this.updateFloorLab(),this.initHandles(),this.manageEventsBindings(),this.scope.$on("reCalcViewDimensions",o),i.element(e).on("resize",o),this.initHasRun=!0,t=a(function(){n.onLowHandleChange()},n.options.interval),s=a(function(){n.onHighHandleChange()},n.options.interval),this.scope.$on("rzSliderForceRender",function(){n.resetLabelsValue(),t(),n.range&&s(),n.resetSlider()}),this.scope.$watch("rzSliderOptions()",function(i,t){i!==t&&(n.applyOptions(),n.syncLowValue(),n.range&&n.syncHighValue(),n.resetSlider())},!0),this.scope.$watch("rzSliderModel",function(i,s){n.internalChange||i!==s&&t()}),this.scope.$watch("rzSliderHigh",function(i,t){n.internalChange||i!==t&&(null!=i&&s(),(n.range&&null==i||!n.range&&null!=i)&&(n.applyOptions(),n.resetSlider()))}),this.scope.$on("$destroy",function(){n.unbindEvents(),i.element(e).off("resize",o),n.currentFocusElement=null})},findStepIndex:function(t){for(var s=0,e=0;e<this.options.stepsArray.length;e++){var n=this.options.stepsArray[e];if(n===t){s=e;break}if(i.isDate(n)){if(n.getTime()===t.getTime()){s=e;break}}else if(i.isObject(n)&&(i.isDate(n.value)&&n.value.getTime()===t.getTime()||n.value===t)){s=e;break}}return s},syncLowValue:function(){this.options.stepsArray?this.options.bindIndexForStepsArray?this.lowValue=this.scope.rzSliderModel:this.lowValue=this.findStepIndex(this.scope.rzSliderModel):this.lowValue=this.scope.rzSliderModel},syncHighValue:function(){this.options.stepsArray?this.options.bindIndexForStepsArray?this.highValue=this.scope.rzSliderHigh:this.highValue=this.findStepIndex(this.scope.rzSliderHigh):this.highValue=this.scope.rzSliderHigh},getStepValue:function(t){var s=this.options.stepsArray[t];return i.isDate(s)?s:i.isObject(s)?s.value:s},applyLowValue:function(){this.options.stepsArray?this.options.bindIndexForStepsArray?this.scope.rzSliderModel=this.lowValue:this.scope.rzSliderModel=this.getStepValue(this.lowValue):this.scope.rzSliderModel=this.lowValue},applyHighValue:function(){this.options.stepsArray?this.options.bindIndexForStepsArray?this.scope.rzSliderHigh=this.highValue:this.scope.rzSliderHigh=this.getStepValue(this.highValue):this.scope.rzSliderHigh=this.highValue},onLowHandleChange:function(){this.syncLowValue(),this.range&&this.syncHighValue(),this.setMinAndMax(),this.updateLowHandle(this.valueToPosition(this.lowValue)),this.updateSelectionBar(),this.updateTicksScale(),this.updateAriaAttributes(),this.range&&this.updateCmbLabel()},onHighHandleChange:function(){this.syncLowValue(),this.syncHighValue(),this.setMinAndMax(),this.updateHighHandle(this.valueToPosition(this.highValue)),this.updateSelectionBar(),this.updateTicksScale(),this.updateCmbLabel(),this.updateAriaAttributes()},applyOptions:function(){var t;t=this.scope.rzSliderOptions?this.scope.rzSliderOptions():{},this.options=o.getOptions(t),this.options.step<=0&&(this.options.step=1),this.range=void 0!==this.scope.rzSliderModel&&void 0!==this.scope.rzSliderHigh,this.options.draggableRange=this.range&&this.options.draggableRange,this.options.draggableRangeOnly=this.range&&this.options.draggableRangeOnly,this.options.draggableRangeOnly&&(this.options.draggableRange=!0),this.options.showTicks=this.options.showTicks||this.options.showTicksValues||!!this.options.ticksArray,this.scope.showTicks=this.options.showTicks,(i.isNumber(this.options.showTicks)||this.options.ticksArray)&&(this.intermediateTicks=!0),this.options.showSelectionBar=this.options.showSelectionBar||this.options.showSelectionBarEnd||null!==this.options.showSelectionBarFromValue,this.options.stepsArray?this.parseStepsArray():(this.options.translate?this.customTrFn=this.options.translate:this.customTrFn=function(i){return String(i)},this.getLegend=this.options.getLegend),this.options.vertical&&(this.positionProperty="bottom",this.dimensionProperty="height"),this.options.customTemplateScope&&(this.scope.custom=this.options.customTemplateScope)},parseStepsArray:function(){this.options.floor=0,this.options.ceil=this.options.stepsArray.length-1,this.options.step=1,this.options.translate?this.customTrFn=this.options.translate:this.customTrFn=function(i){return this.options.bindIndexForStepsArray?this.getStepValue(i):i},this.getLegend=function(t){var s=this.options.stepsArray[t];return i.isObject(s)?s.legend:null}},resetSlider:function(){this.manageElementsStyle(),this.addAccessibility(),this.setMinAndMax(),this.updateCeilLab(),this.updateFloorLab(),this.unbindEvents(),this.manageEventsBindings(),this.setDisabledState(),this.calcViewDimensions(),this.refocusPointerIfNeeded()},refocusPointerIfNeeded:function(){this.currentFocusElement&&(this.onPointerFocus(this.currentFocusElement.pointer,this.currentFocusElement.ref),this.focusElement(this.currentFocusElement.pointer))},initElemHandles:function(){i.forEach(this.sliderElem.children(),function(t,s){var e=i.element(t);switch(s){case 0:this.fullBar=e;break;case 1:this.selBar=e;break;case 2:this.minH=e;break;case 3:this.maxH=e;break;case 4:this.flrLab=e;break;case 5:this.ceilLab=e;break;case 6:this.minLab=e;break;case 7:this.maxLab=e;break;case 8:this.cmbLab=e;break;case 9:this.ticks=e}},this),this.selBar.rzsp=0,this.minH.rzsp=0,this.maxH.rzsp=0,this.flrLab.rzsp=0,this.ceilLab.rzsp=0,this.minLab.rzsp=0,this.maxLab.rzsp=0,this.cmbLab.rzsp=0},manageElementsStyle:function(){this.range?this.maxH.css("display",""):this.maxH.css("display","none"),this.alwaysHide(this.flrLab,this.options.showTicksValues||this.options.hideLimitLabels),this.alwaysHide(this.ceilLab,this.options.showTicksValues||this.options.hideLimitLabels);var i=this.options.showTicksValues&&!this.intermediateTicks;this.alwaysHide(this.minLab,i||this.options.hidePointerLabels),this.alwaysHide(this.maxLab,i||!this.range||this.options.hidePointerLabels),this.alwaysHide(this.cmbLab,i||!this.range||this.options.hidePointerLabels),this.alwaysHide(this.selBar,!this.range&&!this.options.showSelectionBar),this.options.vertical&&this.sliderElem.addClass("rz-vertical"),this.options.draggableRange?this.selBar.addClass("rz-draggable"):this.selBar.removeClass("rz-draggable"),this.intermediateTicks&&this.options.showTicksValues&&this.ticks.addClass("rz-ticks-values-under")},alwaysHide:function(i,t){i.rzAlwaysHide=t,t?this.hideEl(i):this.showEl(i)},manageEventsBindings:function(){this.options.disabled||this.options.readOnly?this.unbindEvents():this.bindEvents()},setDisabledState:function(){this.options.disabled?this.sliderElem.attr("disabled","disabled"):this.sliderElem.attr("disabled",null)},resetLabelsValue:function(){this.minLab.rzsv=void 0,this.maxLab.rzsv=void 0},initHandles:function(){this.updateLowHandle(this.valueToPosition(this.lowValue)),this.range&&this.updateHighHandle(this.valueToPosition(this.highValue)),this.updateSelectionBar(),this.range&&this.updateCmbLabel(),this.updateTicksScale()},translateFn:function(i,t,s,e){e=void 0===e||e;var n="",o=!1,a=t.hasClass("no-label-injection");e?(this.options.stepsArray&&!this.options.bindIndexForStepsArray&&(i=this.getStepValue(i)),n=String(this.customTrFn(i,this.options.id,s))):n=String(i),(void 0===t.rzsv||t.rzsv.length!==n.length||t.rzsv.length>0&&0===t.rzsd)&&(o=!0,t.rzsv=n),a||t.html(n),this.scope[s+"Label"]=n,o&&this.getDimension(t)},setMinAndMax:function(){if(this.step=+this.options.step,this.precision=+this.options.precision,this.minValue=this.options.floor,this.options.logScale&&0===this.minValue)throw Error("Can't use floor=0 with logarithmic scale");this.options.enforceStep&&(this.lowValue=this.roundStep(this.lowValue),this.range&&(this.highValue=this.roundStep(this.highValue))),null!=this.options.ceil?this.maxValue=this.options.ceil:this.maxValue=this.options.ceil=this.range?this.highValue:this.lowValue,this.options.enforceRange&&(this.lowValue=this.sanitizeValue(this.lowValue),this.range&&(this.highValue=this.sanitizeValue(this.highValue))),this.applyLowValue(),this.range&&this.applyHighValue(),this.valueRange=this.maxValue-this.minValue},addAccessibility:function(){this.minH.attr("role","slider"),this.updateAriaAttributes(),!this.options.keyboardSupport||this.options.readOnly||this.options.disabled?this.minH.attr("tabindex",""):this.minH.attr("tabindex","0"),this.options.vertical&&this.minH.attr("aria-orientation","vertical"),this.options.ariaLabel?this.minH.attr("aria-label",this.options.ariaLabel):this.options.ariaLabelledBy&&this.minH.attr("aria-labelledby",this.options.ariaLabelledBy),this.range&&(this.maxH.attr("role","slider"),!this.options.keyboardSupport||this.options.readOnly||this.options.disabled?this.maxH.attr("tabindex",""):this.maxH.attr("tabindex","0"),this.options.vertical&&this.maxH.attr("aria-orientation","vertical"),this.options.ariaLabelHigh?this.maxH.attr("aria-label",this.options.ariaLabelHigh):this.options.ariaLabelledByHigh&&this.maxH.attr("aria-labelledby",this.options.ariaLabelledByHigh))},updateAriaAttributes:function(){this.minH.attr({"aria-valuenow":this.scope.rzSliderModel,"aria-valuetext":this.customTrFn(this.scope.rzSliderModel,this.options.id,"model"),"aria-valuemin":this.minValue,"aria-valuemax":this.maxValue}),this.range&&this.maxH.attr({"aria-valuenow":this.scope.rzSliderHigh,"aria-valuetext":this.customTrFn(this.scope.rzSliderHigh,this.options.id,"high"),"aria-valuemin":this.minValue,"aria-valuemax":this.maxValue})},calcViewDimensions:function(){var i=this.getDimension(this.minH);if(this.handleHalfDim=i/2,this.barDimension=this.getDimension(this.fullBar),this.maxPos=this.barDimension-i,this.getDimension(this.sliderElem),this.sliderElem.rzsp=this.sliderElem[0].getBoundingClientRect()[this.positionProperty],this.initHasRun){this.updateFloorLab(),this.updateCeilLab(),this.initHandles();var s=this;t(function(){s.updateTicksScale()})}},updateTicksScale:function(){if(this.options.showTicks){var i=this.options.ticksArray||this.getTicksArray(),t=this.options.vertical?"translateY":"translateX",s=this;this.options.rightToLeft&&i.reverse(),this.scope.ticks=i.map(function(i){var e=s.valueToPosition(i);s.options.vertical&&(e=s.maxPos-e);var n=t+"("+Math.round(e)+"px)",o={selected:s.isTickSelected(i),style:{"-webkit-transform":n,"-moz-transform":n,"-o-transform":n,"-ms-transform":n,transform:n}};if(o.selected&&s.options.getSelectionBarColor&&(o.style["background-color"]=s.getSelectionBarColor()),!o.selected&&s.options.getTickColor&&(o.style["background-color"]=s.getTickColor(i)),s.options.ticksTooltip&&(o.tooltip=s.options.ticksTooltip(i),o.tooltipPlacement=s.options.vertical?"right":"top"),s.options.showTicksValues&&(o.value=s.getDisplayValue(i,"tick-value"),s.options.ticksValuesTooltip&&(o.valueTooltip=s.options.ticksValuesTooltip(i),o.valueTooltipPlacement=s.options.vertical?"right":"top")),s.getLegend){var a=s.getLegend(i,s.options.id);a&&(o.legend=a)}return o})}},getTicksArray:function(){var i=this.step,t=[];this.intermediateTicks&&(i=this.options.showTicks);for(var s=this.minValue;s<=this.maxValue;s+=i)t.push(s);return t},isTickSelected:function(i){if(!this.range)if(null!==this.options.showSelectionBarFromValue){var t=this.options.showSelectionBarFromValue;if(this.lowValue>t&&i>=t&&i<=this.lowValue)return!0;if(this.lowValue<t&&t>=i&&i>=this.lowValue)return!0}else if(this.options.showSelectionBarEnd){if(i>=this.lowValue)return!0}else if(this.options.showSelectionBar&&i<=this.lowValue)return!0;return!!(this.range&&i>=this.lowValue&&i<=this.highValue)},updateFloorLab:function(){this.translateFn(this.minValue,this.flrLab,"floor"),this.getDimension(this.flrLab);var i=this.options.rightToLeft?this.barDimension-this.flrLab.rzsd:0;this.setPosition(this.flrLab,i)},updateCeilLab:function(){this.translateFn(this.maxValue,this.ceilLab,"ceil"),this.getDimension(this.ceilLab);var i=this.options.rightToLeft?0:this.barDimension-this.ceilLab.rzsd;this.setPosition(this.ceilLab,i)},updateHandles:function(i,t){"lowValue"===i?this.updateLowHandle(t):this.updateHighHandle(t),this.updateSelectionBar(),this.updateTicksScale(),this.range&&this.updateCmbLabel()},getHandleLabelPos:function(i,t){var s=this[i].rzsd,e=t-s/2+this.handleHalfDim,n=this.barDimension-s;return this.options.boundPointerLabels?this.options.rightToLeft&&"minLab"===i||!this.options.rightToLeft&&"maxLab"===i?Math.min(e,n):Math.min(Math.max(e,0),n):e},updateLowHandle:function(i){if(this.setPosition(this.minH,i),this.translateFn(this.lowValue,this.minLab,"model"),this.setPosition(this.minLab,this.getHandleLabelPos("minLab",i)),this.options.getPointerColor){var t=this.getPointerColor("min");this.scope.minPointerStyle={backgroundColor:t}}this.options.autoHideLimitLabels&&this.shFloorCeil()},updateHighHandle:function(i){if(this.setPosition(this.maxH,i),this.translateFn(this.highValue,this.maxLab,"high"),this.setPosition(this.maxLab,this.getHandleLabelPos("maxLab",i)),this.options.getPointerColor){var t=this.getPointerColor("max");this.scope.maxPointerStyle={backgroundColor:t}}this.options.autoHideLimitLabels&&this.shFloorCeil()},shFloorCeil:function(){if(!this.options.hidePointerLabels){var i=!1,t=!1,s=this.isLabelBelowFloorLab(this.minLab),e=this.isLabelAboveCeilLab(this.minLab),n=this.isLabelAboveCeilLab(this.maxLab),o=this.isLabelBelowFloorLab(this.cmbLab),a=this.isLabelAboveCeilLab(this.cmbLab);if(s?(i=!0,this.hideEl(this.flrLab)):(i=!1,this.showEl(this.flrLab)),e?(t=!0,this.hideEl(this.ceilLab)):(t=!1,this.showEl(this.ceilLab)),this.range){var h=this.cmbLabelShown?a:n,l=this.cmbLabelShown?o:s;h?this.hideEl(this.ceilLab):t||this.showEl(this.ceilLab),l?this.hideEl(this.flrLab):i||this.showEl(this.flrLab)}}},isLabelBelowFloorLab:function(i){var t=this.options.rightToLeft,s=i.rzsp,e=i.rzsd,n=this.flrLab.rzsp,o=this.flrLab.rzsd;return t?s+e>=n-2:n+o+2>=s},isLabelAboveCeilLab:function(i){var t=this.options.rightToLeft,s=i.rzsp,e=i.rzsd,n=this.ceilLab.rzsp,o=this.ceilLab.rzsd;return t?n+o+2>=s:s+e>=n-2},updateSelectionBar:function(){var i=0,t=0,s=this.options.rightToLeft?!this.options.showSelectionBarEnd:this.options.showSelectionBarEnd,e=this.options.rightToLeft?this.maxH.rzsp+this.handleHalfDim:this.minH.rzsp+this.handleHalfDim;if(this.range)t=Math.abs(this.maxH.rzsp-this.minH.rzsp),i=e;else if(null!==this.options.showSelectionBarFromValue){var n=this.options.showSelectionBarFromValue,o=this.valueToPosition(n),a=this.options.rightToLeft?this.lowValue<=n:this.lowValue>n;a?(t=this.minH.rzsp-o,i=o+this.handleHalfDim):(t=o-this.minH.rzsp,i=this.minH.rzsp+this.handleHalfDim)}else s?(t=Math.abs(this.maxPos-this.minH.rzsp)+this.handleHalfDim,i=this.minH.rzsp+this.handleHalfDim):(t=Math.abs(this.maxH.rzsp-this.minH.rzsp)+this.handleHalfDim,i=0);if(this.setDimension(this.selBar,t),this.setPosition(this.selBar,i),this.options.getSelectionBarColor){var h=this.getSelectionBarColor();this.scope.barStyle={backgroundColor:h}}else if(this.options.selectionBarGradient){var l=null!==this.options.showSelectionBarFromValue?this.valueToPosition(this.options.showSelectionBarFromValue):0,r=l-i>0^s,u=this.options.vertical?r?"bottom":"top":r?"left":"right";this.scope.barStyle={backgroundImage:"linear-gradient(to "+u+", "+this.options.selectionBarGradient.from+" 0%,"+this.options.selectionBarGradient.to+" 100%)"},this.options.vertical?(this.scope.barStyle.backgroundPosition="center "+(l+t+i+(r?-this.handleHalfDim:0))+"px",this.scope.barStyle.backgroundSize="100% "+(this.barDimension-this.handleHalfDim)+"px"):(this.scope.barStyle.backgroundPosition=l-i+(r?this.handleHalfDim:0)+"px center",this.scope.barStyle.backgroundSize=this.barDimension-this.handleHalfDim+"px 100%")}},getSelectionBarColor:function(){return this.range?this.options.getSelectionBarColor(this.scope.rzSliderModel,this.scope.rzSliderHigh):this.options.getSelectionBarColor(this.scope.rzSliderModel)},getPointerColor:function(i){return"max"===i?this.options.getPointerColor(this.scope.rzSliderHigh,i):this.options.getPointerColor(this.scope.rzSliderModel,i)},getTickColor:function(i){return this.options.getTickColor(i)},updateCmbLabel:function(){if(this.options.rightToLeft?this.minLab.rzsp-this.minLab.rzsd-10<=this.maxLab.rzsp:this.minLab.rzsp+this.minLab.rzsd+10>=this.maxLab.rzsp){var i=this.getDisplayValue(this.lowValue,"model"),t=this.getDisplayValue(this.highValue,"high"),s="";s=this.options.mergeRangeLabelsIfSame&&i===t?i:this.options.rightToLeft?t+" - "+i:i+" - "+t,this.translateFn(s,this.cmbLab,"cmb",!1);var e=this.options.boundPointerLabels?Math.min(Math.max(this.selBar.rzsp+this.selBar.rzsd/2-this.cmbLab.rzsd/2,0),this.barDimension-this.cmbLab.rzsd):this.selBar.rzsp+this.selBar.rzsd/2-this.cmbLab.rzsd/2;this.setPosition(this.cmbLab,e),this.cmbLabelShown=!0,this.hideEl(this.minLab),this.hideEl(this.maxLab),this.showEl(this.cmbLab)}else this.cmbLabelShown=!1,this.updateHighHandle(this.valueToPosition(this.highValue)),this.updateLowHandle(this.valueToPosition(this.lowValue)),this.showEl(this.maxLab),this.showEl(this.minLab),this.hideEl(this.cmbLab);this.options.autoHideLimitLabels&&this.shFloorCeil()},getDisplayValue:function(i,t){return this.options.stepsArray&&!this.options.bindIndexForStepsArray&&(i=this.getStepValue(i)),this.customTrFn(i,this.options.id,t)},roundStep:function(i,t){var s=t||this.step,e=parseFloat((i-this.minValue)/s).toPrecision(12);return e=Math.round(+e)*s,+(this.minValue+e).toFixed(this.precision)},hideEl:function(i){return i.css({visibility:"hidden"})},showEl:function(i){return i.rzAlwaysHide?i:i.css({visibility:"visible"})},setPosition:function(i,t){i.rzsp=t;var s={};return s[this.positionProperty]=Math.round(t)+"px",i.css(s),t},getDimension:function(i){var t=i[0].getBoundingClientRect();return this.options.vertical?i.rzsd=(t.bottom-t.top)*this.options.scale:i.rzsd=(t.right-t.left)*this.options.scale,i.rzsd},setDimension:function(i,t){i.rzsd=t;var s={};return s[this.dimensionProperty]=Math.round(t)+"px",i.css(s),t},sanitizeValue:function(i){return Math.min(Math.max(i,this.minValue),this.maxValue)},valueToPosition:function(i){var t=this.linearValueToPosition;this.options.customValueToPosition?t=this.options.customValueToPosition:this.options.logScale&&(t=this.logValueToPosition),i=this.sanitizeValue(i);var s=t(i,this.minValue,this.maxValue)||0;return this.options.rightToLeft&&(s=1-s),s*this.maxPos},linearValueToPosition:function(i,t,s){return(i-t)/(s-t)},logValueToPosition:function(i,t,s){return i=Math.log(i),t=Math.log(t),s=Math.log(s),(i-t)/(s-t)},positionToValue:function(i){var t=i/this.maxPos;this.options.rightToLeft&&(t=1-t);var s=this.linearPositionToValue;return this.options.customPositionToValue?s=this.options.customPositionToValue:this.options.logScale&&(s=this.logPositionToValue),s(t,this.minValue,this.maxValue)||0},linearPositionToValue:function(i,t,s){return i*(s-t)+t},logPositionToValue:function(i,t,s){t=Math.log(t),s=Math.log(s);var e=i*(s-t)+t;return Math.exp(e)},getEventXY:function(i){var t=this.options.vertical?"clientY":"clientX";return void 0!==i[t]?i[t]:void 0===i.originalEvent?i.touches[0][t]:i.originalEvent.touches[0][t]},getEventPosition:function(i){var t=this.sliderElem.rzsp;return(this.options.vertical?-this.getEventXY(i)+t:this.getEventXY(i)-t)*this.options.scale-this.handleHalfDim},getEventNames:function(i){var t={moveEvent:"",endEvent:""};return i.touches||void 0!==i.originalEvent&&i.originalEvent.touches?(t.moveEvent="touchmove",t.endEvent="touchend"):(t.moveEvent="mousemove",t.endEvent="mouseup"),t},getNearestHandle:function(i){if(!this.range)return this.minH;var t=this.getEventPosition(i),s=Math.abs(t-this.minH.rzsp),e=Math.abs(t-this.maxH.rzsp);return e>s?this.minH:s>e?this.maxH:this.options.rightToLeft?t>this.minH.rzsp?this.minH:this.maxH:t<this.minH.rzsp?this.minH:this.maxH},focusElement:function(i){i[0].focus()},bindEvents:function(){var t,s,e;this.options.draggableRange?(t="rzSliderDrag",s=this.onDragStart,e=this.onDragMove):(t="lowValue",s=this.onStart,e=this.onMove),this.options.onlyBindHandles||(this.selBar.on("mousedown",i.bind(this,s,null,t)),this.selBar.on("mousedown",i.bind(this,e,this.selBar))),this.options.draggableRangeOnly?(this.minH.on("mousedown",i.bind(this,s,null,t)),this.maxH.on("mousedown",i.bind(this,s,null,t))):(this.minH.on("mousedown",i.bind(this,this.onStart,this.minH,"lowValue")),this.range&&this.maxH.on("mousedown",i.bind(this,this.onStart,this.maxH,"highValue")),this.options.onlyBindHandles||(this.fullBar.on("mousedown",i.bind(this,this.onStart,null,null)),this.fullBar.on("mousedown",i.bind(this,this.onMove,this.fullBar)),this.ticks.on("mousedown",i.bind(this,this.onStart,null,null)),this.ticks.on("mousedown",i.bind(this,this.onTickClick,this.ticks)))),this.options.onlyBindHandles||(this.selBar.on("touchstart",i.bind(this,s,null,t)),this.selBar.on("touchstart",i.bind(this,e,this.selBar))),this.options.draggableRangeOnly?(this.minH.on("touchstart",i.bind(this,s,null,t)),this.maxH.on("touchstart",i.bind(this,s,null,t))):(this.minH.on("touchstart",i.bind(this,this.onStart,this.minH,"lowValue")),this.range&&this.maxH.on("touchstart",i.bind(this,this.onStart,this.maxH,"highValue")),this.options.onlyBindHandles||(this.fullBar.on("touchstart",i.bind(this,this.onStart,null,null)),this.fullBar.on("touchstart",i.bind(this,this.onMove,this.fullBar)),this.ticks.on("touchstart",i.bind(this,this.onStart,null,null)),this.ticks.on("touchstart",i.bind(this,this.onTickClick,this.ticks)))),this.options.keyboardSupport&&(this.minH.on("focus",i.bind(this,this.onPointerFocus,this.minH,"lowValue")),this.range&&this.maxH.on("focus",i.bind(this,this.onPointerFocus,this.maxH,"highValue")))},unbindEvents:function(){this.minH.off(),this.maxH.off(),this.fullBar.off(),this.selBar.off(),this.ticks.off()},onStart:function(t,e,n){var o,a,h=this.getEventNames(n);n.stopPropagation(),n.preventDefault(),this.calcViewDimensions(),t?this.tracking=e:(t=this.getNearestHandle(n),this.tracking=t===this.minH?"lowValue":"highValue"),t.addClass("rz-active"),this.options.keyboardSupport&&this.focusElement(t),o=i.bind(this,this.dragging.active?this.onDragMove:this.onMove,t),a=i.bind(this,this.onEnd,o),s.on(h.moveEvent,o),s.one(h.endEvent,a),this.callOnStart()},onMove:function(t,s,e){var n,o=this.getEventPosition(s),a=this.options.rightToLeft?this.minValue:this.maxValue,h=this.options.rightToLeft?this.maxValue:this.minValue;0>=o?n=h:o>=this.maxPos?n=a:(n=this.positionToValue(o),n=e&&i.isNumber(this.options.showTicks)?this.roundStep(n,this.options.showTicks):this.roundStep(n)),this.positionTrackingHandle(n)},onEnd:function(i,t){var e=this.getEventNames(t).moveEvent;this.options.keyboardSupport||(this.minH.removeClass("rz-active"),this.maxH.removeClass("rz-active"),this.tracking=""),this.dragging.active=!1,s.off(e,i),this.callOnEnd()},onTickClick:function(i,t){this.onMove(i,t,!0)},onPointerFocus:function(t,s){this.tracking=s,t.one("blur",i.bind(this,this.onPointerBlur,t)),t.on("keydown",i.bind(this,this.onKeyboardEvent)),t.on("keyup",i.bind(this,this.onKeyUp)),this.firstKeyDown=!0,t.addClass("rz-active"),this.currentFocusElement={pointer:t,ref:s}},onKeyUp:function(){this.firstKeyDown=!0,this.callOnEnd()},onPointerBlur:function(i){i.off("keydown"),i.off("keyup"),this.tracking="",i.removeClass("rz-active"),this.currentFocusElement=null},getKeyActions:function(i){var t=i+this.step,s=i-this.step,e=i+this.valueRange/10,n=i-this.valueRange/10,o={UP:t,DOWN:s,LEFT:s,RIGHT:t,PAGEUP:e,PAGEDOWN:n,HOME:this.minValue,END:this.maxValue};return this.options.rightToLeft&&(o.LEFT=t,o.RIGHT=s,this.options.vertical&&(o.UP=s,o.DOWN=t)),o},onKeyboardEvent:function(i){var s=this[this.tracking],e=i.keyCode||i.which,n={38:"UP",40:"DOWN",37:"LEFT",39:"RIGHT",33:"PAGEUP",34:"PAGEDOWN",36:"HOME",35:"END"},o=this.getKeyActions(s),a=n[e],h=o[a];if(null!=h&&""!==this.tracking){i.preventDefault(),this.firstKeyDown&&(this.firstKeyDown=!1,this.callOnStart());var l=this;t(function(){var i=l.roundStep(l.sanitizeValue(h));if(l.options.draggableRangeOnly){var t,s,e=l.highValue-l.lowValue;"lowValue"===l.tracking?(t=i,(s=i+e)>l.maxValue&&(s=l.maxValue,t=s-e)):(s=i,(t=i-e)<l.minValue&&(t=l.minValue,s=t+e)),l.positionTrackingBar(t,s)}else l.positionTrackingHandle(i)})}},onDragStart:function(i,t,s){var e=this.getEventPosition(s);this.dragging={active:!0,value:this.positionToValue(e),difference:this.highValue-this.lowValue,lowLimit:this.options.rightToLeft?this.minH.rzsp-e:e-this.minH.rzsp,highLimit:this.options.rightToLeft?e-this.maxH.rzsp:this.maxH.rzsp-e},this.onStart(i,t,s)},getValue:function(i,t,s,e){var n=this.options.rightToLeft,o=null;return o="min"===i?s?e?n?this.minValue:this.maxValue-this.dragging.difference:n?this.maxValue-this.dragging.difference:this.minValue:n?this.positionToValue(t+this.dragging.lowLimit):this.positionToValue(t-this.dragging.lowLimit):s?e?n?this.minValue+this.dragging.difference:this.maxValue:n?this.maxValue:this.minValue+this.dragging.difference:n?this.positionToValue(t+this.dragging.lowLimit)+this.dragging.difference:this.positionToValue(t-this.dragging.lowLimit)+this.dragging.difference,this.roundStep(o)},onDragMove:function(i,t){var s,e,n,o,a,h,l,r,u=this.getEventPosition(t);if(this.options.rightToLeft?(n=this.dragging.lowLimit,o=this.dragging.highLimit,l=this.maxH,r=this.minH):(n=this.dragging.highLimit,o=this.dragging.lowLimit,l=this.minH,r=this.maxH),a=o>=u,h=u>=this.maxPos-n,a){if(0===l.rzsp)return;s=this.getValue("min",u,!0,!1),e=this.getValue("max",u,!0,!1)}else if(h){if(r.rzsp===this.maxPos)return;e=this.getValue("max",u,!0,!0),s=this.getValue("min",u,!0,!0)}else s=this.getValue("min",u,!1),e=this.getValue("max",u,!1);this.positionTrackingBar(s,e)},positionTrackingBar:function(i,t){null!=this.options.minLimit&&i<this.options.minLimit&&(i=this.options.minLimit,t=i+this.dragging.difference),null!=this.options.maxLimit&&t>this.options.maxLimit&&(t=this.options.maxLimit,i=t-this.dragging.difference),this.lowValue=i,this.highValue=t,this.applyLowValue(),this.range&&this.applyHighValue(),this.applyModel(!0),this.updateHandles("lowValue",this.valueToPosition(i)),this.updateHandles("highValue",this.valueToPosition(t))},positionTrackingHandle:function(i){var t=!1;i=this.applyMinMaxLimit(i),this.range&&(this.options.pushRange?(i=this.applyPushRange(i),t=!0):(this.options.noSwitching&&("lowValue"===this.tracking&&i>this.highValue?i=this.applyMinMaxRange(this.highValue):"highValue"===this.tracking&&i<this.lowValue&&(i=this.applyMinMaxRange(this.lowValue))),i=this.applyMinMaxRange(i),"lowValue"===this.tracking&&i>this.highValue?(this.lowValue=this.highValue,this.applyLowValue(),this.applyModel(),this.updateHandles(this.tracking,this.maxH.rzsp),this.updateAriaAttributes(),this.tracking="highValue",this.minH.removeClass("rz-active"),this.maxH.addClass("rz-active"),this.options.keyboardSupport&&this.focusElement(this.maxH),t=!0):"highValue"===this.tracking&&i<this.lowValue&&(this.highValue=this.lowValue,this.applyHighValue(),this.applyModel(),this.updateHandles(this.tracking,this.minH.rzsp),this.updateAriaAttributes(),this.tracking="lowValue",this.maxH.removeClass("rz-active"),this.minH.addClass("rz-active"),this.options.keyboardSupport&&this.focusElement(this.minH),t=!0))),this[this.tracking]!==i&&(this[this.tracking]=i,"lowValue"===this.tracking?this.applyLowValue():this.applyHighValue(),this.applyModel(),this.updateHandles(this.tracking,this.valueToPosition(i)),this.updateAriaAttributes(),t=!0),t&&this.applyModel(!0)},applyMinMaxLimit:function(i){return null!=this.options.minLimit&&i<this.options.minLimit?this.options.minLimit:null!=this.options.maxLimit&&i>this.options.maxLimit?this.options.maxLimit:i},applyMinMaxRange:function(i){var t="lowValue"===this.tracking?this.highValue:this.lowValue,s=Math.abs(i-t);return null!=this.options.minRange&&s<this.options.minRange?"lowValue"===this.tracking?this.highValue-this.options.minRange:this.lowValue+this.options.minRange:null!=this.options.maxRange&&s>this.options.maxRange?"lowValue"===this.tracking?this.highValue-this.options.maxRange:this.lowValue+this.options.maxRange:i},applyPushRange:function(i){var t="lowValue"===this.tracking?this.highValue-i:i-this.lowValue,s=null!==this.options.minRange?this.options.minRange:this.options.step,e=this.options.maxRange;return s>t?("lowValue"===this.tracking?(this.highValue=Math.min(i+s,this.maxValue),i=this.highValue-s,this.applyHighValue(),this.updateHandles("highValue",this.valueToPosition(this.highValue))):(this.lowValue=Math.max(i-s,this.minValue),i=this.lowValue+s,this.applyLowValue(),this.updateHandles("lowValue",this.valueToPosition(this.lowValue))),this.updateAriaAttributes()):null!==e&&t>e&&("lowValue"===this.tracking?(this.highValue=i+e,this.applyHighValue(),this.updateHandles("highValue",this.valueToPosition(this.highValue))):(this.lowValue=i-e,this.applyLowValue(),this.updateHandles("lowValue",this.valueToPosition(this.lowValue))),this.updateAriaAttributes()),i},applyModel:function(i){this.internalChange=!0,this.scope.$apply(),i&&this.callOnChange(),this.internalChange=!1},callOnStart:function(){if(this.options.onStart){var i=this,t="lowValue"===this.tracking?"min":"max";this.scope.$evalAsync(function(){i.options.onStart(i.options.id,i.scope.rzSliderModel,i.scope.rzSliderHigh,t)})}},
callOnChange:function(){if(this.options.onChange){var i=this,t="lowValue"===this.tracking?"min":"max";this.scope.$evalAsync(function(){i.options.onChange(i.options.id,i.scope.rzSliderModel,i.scope.rzSliderHigh,t)})}},callOnEnd:function(){if(this.options.onEnd){var i=this,t="lowValue"===this.tracking?"min":"max";this.scope.$evalAsync(function(){i.options.onEnd(i.options.id,i.scope.rzSliderModel,i.scope.rzSliderHigh,t)})}this.scope.$emit("slideEnded")}},h}]).directive("rzslider",["RzSlider",function(i){return{restrict:"AE",replace:!0,scope:{rzSliderModel:"=?",rzSliderHigh:"=?",rzSliderOptions:"&?",rzSliderTplUrl:"@"},templateUrl:function(i,t){return t.rzSliderTplUrl||"rzSliderTpl.html"},link:function(t,s){t.slider=new i(t,s)}}}]);return t.run(["$templateCache",function(i){i.put("rzSliderTpl.html",'<div class=rzslider><span class=rz-bar-wrapper><span class=rz-bar></span></span> <span class=rz-bar-wrapper><span class="rz-bar rz-selection" ng-style=barStyle></span></span> <span class="rz-pointer rz-pointer-min" ng-style=minPointerStyle></span> <span class="rz-pointer rz-pointer-max" ng-style=maxPointerStyle></span> <span class="rz-bubble rz-limit rz-floor"></span> <span class="rz-bubble rz-limit rz-ceil"></span> <span class=rz-bubble></span> <span class=rz-bubble></span> <span class=rz-bubble></span><ul ng-show=showTicks class=rz-ticks><li ng-repeat="t in ticks track by $index" class=rz-tick ng-class="{\'rz-selected\': t.selected}" ng-style=t.style ng-attr-uib-tooltip="{{ t.tooltip }}" ng-attr-tooltip-placement={{t.tooltipPlacement}} ng-attr-tooltip-append-to-body="{{ t.tooltip ? true : undefined}}"><span ng-if="t.value != null" class=rz-tick-value ng-attr-uib-tooltip="{{ t.valueTooltip }}" ng-attr-tooltip-placement={{t.valueTooltipPlacement}}>{{ t.value }}</span> <span ng-if="t.legend != null" class=rz-tick-legend>{{ t.legend }}</span></li></ul></div>')}]),t.name});